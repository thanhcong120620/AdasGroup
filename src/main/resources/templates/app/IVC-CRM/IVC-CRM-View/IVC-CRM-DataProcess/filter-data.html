<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>CRM Data Management</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="p-4">
    <div class="container-fluid">
        <!-- Form lọc -->
        <div class="card mb-4">
            <div class="card-header">Bộ lọc khớp chính xác</div>
            <div class="card-body">
                <form th:action="@{/filter-page}" th:object="${searchRequest}" method="get" class="row g-3">
                    <div class="col-md-3">
                        <label>Tên Zalo (Chính xác)</label>
                        <input type="text" th:field="*{zaloName}" class="form-control">
                    </div>
                    <div class="col-md-3">
                        <label>SĐT 1 (Chính xác)</label>
                        <input type="text" th:field="*{phoneNumber1}" class="form-control">
                    </div>
                    <div class="col-md-2">
                        <label>DataType</label>
                        <select th:field="*{dataType}" class="form-select">
                            <option value="">-- Tất cả --</option>
                            <option th:each="t : ${allDataTypes}" th:value="${t}" th:text="${t}"></option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label>Giới tính</label>
                        <select th:field="*{gender}" class="form-select">
                            <option value="">-- Tất cả --</option>
                            <option th:each="g : ${allGenders}" th:value="${g}" th:text="${g}"></option>
                        </select>
                    </div>
                    <div class="col-md-2 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100">Lọc ngay</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Bảng dữ liệu -->
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Zalo Name</th>
                    <th>Phone</th>
                    <th>Type</th>
                    <th>Gender</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="item : ${page.content}">
                    <td th:text="${item.id}"></td>
                    <td th:text="${item.zaloName}"></td>
                    <td th:text="${item.phoneNumber1}"></td>
                    <td th:text="${item.dataType}"></td>
                    <td th:text="${item.gender}"></td>
                </tr>
            </tbody>
        </table>

        <!-- Phân trang -->
        <!-- Phân trang tối ưu -->
<nav th:if="${page.totalPages > 0}" aria-label="Page navigation">
    <ul class="pagination justify-content-center">
        
        <!-- Nút về Trang Đầu (First) -->
        <li class="page-item" th:classappend="${page.first} ? 'disabled'">
            <a class="page-link" th:href="@{/filter-page(page=0, size=${page.size}, zaloName=${searchRequest.zaloName}, phoneNumber1=${searchRequest.phoneNumber1}, dataType=${searchRequest.dataType}, gender=${searchRequest.gender})}">« Đầu</a>
        </li>

        <!-- Nút Trước (Previous) -->
        <li class="page-item" th:classappend="${page.first} ? 'disabled'">
            <a class="page-link" th:href="@{/filter-page(page=${page.number - 1}, size=${page.size}, zaloName=${searchRequest.zaloName}, phoneNumber1=${searchRequest.phoneNumber1}, dataType=${searchRequest.dataType}, gender=${searchRequest.gender})}">‹</a>
        </li>

        <!-- Hiển thị các số trang trong khoảng startPage -> endPage -->
        <li class="page-item" th:each="i : ${#numbers.sequence(startPage, endPage)}" 
            th:classappend="${i == page.number} ? 'active'">
            <a class="page-link" 
               th:href="@{/filter-page(page=${i}, size=${page.size}, zaloName=${searchRequest.zaloName}, phoneNumber1=${searchRequest.phoneNumber1}, dataType=${searchRequest.dataType}, gender=${searchRequest.gender})}" 
               th:text="${i + 1}"></a>
        </li>

        <!-- Nút Sau (Next) -->
        <li class="page-item" th:classappend="${page.last} ? 'disabled'">
            <a class="page-link" th:href="@{/filter-page(page=${page.number + 1}, size=${page.size}, zaloName=${searchRequest.zaloName}, phoneNumber1=${searchRequest.phoneNumber1}, dataType=${searchRequest.dataType}, gender=${searchRequest.gender})}">›</a>
        </li>

        <!-- Nút về Trang Cuối (Last) -->
        <li class="page-item" th:classappend="${page.last} ? 'disabled'">
            <a class="page-link" th:href="@{/filter-page(page=${page.totalPages - 1}, size=${page.size}, zaloName=${searchRequest.zaloName}, phoneNumber1=${searchRequest.phoneNumber1}, dataType=${searchRequest.dataType}, gender=${searchRequest.gender})}">Cuối »</a>
        </li>
    </ul>
</nav>
        
        
    </div>
</body>
</html>